import{v as e,x as t,z as a,r,V as l,c as s,d as o,o as n,p as d,L as u,u as i,M as c,W as v,G as p,H as x,B as g,I as b,D as y,O as f,C as m,P as h}from"./vendor-vue-CxubmH21.js";import{u as k}from"./vendor-ui-Xy_LgOPl.js";import{u as w,r as I,a as S,c as j,d as _,f as M}from"./index-D5PFYhQe.js";import{r as C,a as P}from"./ServerIcon-BaaHcScl.js";import"./vendor-utils-DBvwmA_a.js";import"./vendor-charts-JXtrNU4K.js";function L(r,l){return t(),e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 0 1 0 3.75H5.625a1.875 1.875 0 0 1 0-3.75Z"})])}const D={class:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700"},T={class:"flex flex-col sm:flex-row gap-4"},E={class:"relative flex-1"},A=["disabled"],B={key:0,class:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl p-6 text-center"},O={class:"text-amber-700 dark:text-amber-300"},R={key:0,class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 text-center"},U={class:"relative w-40 h-40 mx-auto mb-4"},q={class:"w-full h-full",viewBox:"0 0 140 140"},H=["stroke-dashoffset"],N={class:"absolute inset-0 flex flex-col items-center justify-center"},V={class:"text-3xl font-bold text-gray-900 dark:text-white"},z={class:"text-sm text-gray-500 dark:text-gray-400"},F={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6"},G={class:"grid grid-cols-1 sm:grid-cols-3 gap-6 text-center"},J={class:"inline-flex items-center justify-center w-12 h-12 bg-blue-100 dark:bg-blue-900/30 rounded-xl mb-3"},K={class:"text-2xl font-bold text-gray-900 dark:text-white"},Q={class:"inline-flex items-center justify-center w-12 h-12 bg-green-100 dark:bg-green-900/30 rounded-xl mb-3"},W={class:"text-2xl font-bold text-gray-900 dark:text-white"},Z={class:"inline-flex items-center justify-center w-12 h-12 bg-purple-100 dark:bg-purple-900/30 rounded-xl mb-3"},$={class:"text-2xl font-bold text-gray-900 dark:text-white"},X={key:0,class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6"},Y={class:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center"},ee={class:"grid grid-cols-1 sm:grid-cols-3 gap-4 text-center"},te={class:"font-semibold text-gray-800 dark:text-gray-200"},ae={class:"font-semibold text-gray-800 dark:text-gray-200"},re={class:"font-semibold text-gray-800 dark:text-gray-200"},le={key:1,class:"text-center"},se=["href"],oe=["src"],ne={__name:"SpeedtestNet",setup(ne){const de=w(),ue=r(!1),ie=r(""),ce=r(!1),ve=r(!1),pe=r(!1),xe=r(""),ge=r(),be=r(),{apply:ye}=k(ge,{initial:{opacity:0,y:20},enter:{opacity:1,y:0,transition:{duration:300}}}),{apply:fe}=k(be,{initial:{opacity:0,scale:.95},enter:{opacity:1,scale:1,transition:{type:"spring",stiffness:100,damping:15}}});let me=l(new AbortController);const he=r({pos:0,total:0}),ke=r({sub:0,full:0}),we=r({ping:"0",download:"",upload:"",result:"",serverInfo:{id:"",name:"",pos:""}}),Ie=2*Math.PI*60,Se=s(()=>Ie-ke.value.full/100*Ie),je=e=>{const t=JSON.parse(e.data);switch(t.type){case"queue":ve.value=!0,he.value.pos=t.pos,he.value.total=t.totalPos;break;case"testStart":ve.value=!1,pe.value=!0,we.value.serverInfo.id=t.server.id,we.value.serverInfo.name=t.server.name,we.value.serverInfo.pos=t.server.country+" - "+t.server.location;break;case"ping":xe.value="Testing latency",we.value.ping=t.ping.latency.toFixed(2);break;case"download":xe.value="Download test",we.value.download=M(t.download.bandwidth,2,!0),ke.value.sub=Math.round(100*t.download.progress),ke.value.full=Math.round(ke.value.sub/2);break;case"upload":xe.value="Upload test",we.value.upload=M(t.upload.bandwidth,2,!0),ke.value.sub=Math.round(100*t.upload.progress),ke.value.full=50+Math.round(ke.value.sub/2);break;case"result":we.value.result=t.result.url,we.value.download=M(t.download.bandwidth,2,!0),we.value.upload=M(t.upload.bandwidth,2,!0),ke.value.full=100,fe()}},_e=()=>{me.abort(""),de.source.removeEventListener("SpeedtestStream",je),pe.value=!1,ue.value=!1},Me=()=>{return e=this,t=null,a=function*(){if(ue.value)return _e();me=new AbortController,ue.value=!0,pe.value=!0,xe.value="",ce.value=!1,ve.value=!1,ke.value={sub:0,full:0},we.value={ping:"0",download:"",upload:"",result:"",serverInfo:{id:"",name:"",pos:""}},de.source.addEventListener("SpeedtestStream",je);try{yield de.requestMethod("speedtest_dot_net",{node_id:ie.value},me.signal)}catch(e){"AbortError"!==e.name&&(ce.value=!0)}de.source.removeEventListener("SpeedtestStream",je),ue.value=!1},new Promise((r,l)=>{var s=e=>{try{n(a.next(e))}catch(t){l(t)}},o=e=>{try{n(a.throw(e))}catch(t){l(t)}},n=e=>e.done?r(e.value):Promise.resolve(e.value).then(s,o);n((a=a.apply(e,t)).next())});var e,t,a};return o(()=>{ye()}),n(()=>{_e()}),(r,l)=>(t(),e("div",{ref_key:"containerRef",ref:ge,class:"space-y-6"},[a("div",D,[a("div",T,[a("div",E,[d(i(C),{class:"w-5 h-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"}),u(a("input",{"onUpdate:modelValue":l[0]||(l[0]=e=>ie.value=e),disabled:ue.value,type:"text",placeholder:"Server ID (Optional)",class:"w-full pl-10 pr-4 py-3 bg-transparent border-0 rounded-xl focus:ring-0 transition-all duration-200 disabled:opacity-50",onKeyup:v(Me,["enter"])},null,40,A),[[c,ie.value]])]),a("button",{onClick:Me,class:p(["inline-flex items-center justify-center px-6 py-3 rounded-xl font-medium transition-all duration-200",ue.value?"bg-red-500 hover:bg-red-600 text-white":"bg-purple-500 hover:bg-purple-600 text-white hover:shadow-lg"])},[(t(),x(b(ue.value?i(I):i(S)),{class:"w-5 h-5 mr-2"})),g(" "+y(ue.value?"Stop Test":"Start Test"),1)],2)])]),d(h,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100"},{default:f(()=>[ve.value?(t(),e("div",B,[d(i(L),{class:"w-10 h-10 text-amber-500 mx-auto mb-3"}),l[1]||(l[1]=a("h3",{class:"text-lg font-semibold text-amber-900 dark:text-amber-100 mb-1"}," Test in Queue ",-1)),a("p",O," Position "+y(he.value.pos)+" of "+y(he.value.total),1)])):m("",!0)]),_:1}),d(h,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100"},{default:f(()=>[!ve.value&&pe.value&&ue.value?(t(),e("div",R,[a("div",U,[(t(),e("svg",q,[l[2]||(l[2]=a("circle",{class:"text-gray-200 dark:text-gray-700","stroke-width":"10",stroke:"currentColor",fill:"transparent",r:"60",cx:"70",cy:"70"},null,-1)),a("circle",{class:"text-purple-500","stroke-width":"10","stroke-dasharray":Ie,"stroke-dashoffset":Se.value,"stroke-linecap":"round",stroke:"currentColor",fill:"transparent",r:"60",cx:"70",cy:"70",style:{transition:"stroke-dashoffset 0.3s"}},null,8,H)])),a("div",N,[a("span",V,y(ke.value.full)+"%",1),a("span",z,y(xe.value),1)])])])):m("",!0)]),_:1}),d(h,{"enter-active-class":"transition-all duration-500 ease-out","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100"},{default:f(()=>["0"!==we.value.ping?(t(),e("div",{key:0,ref_key:"resultRef",ref:be,class:"space-y-6"},[a("div",F,[a("div",G,[a("div",null,[a("div",J,[d(i(P),{class:"w-6 h-6 text-blue-600 dark:text-blue-400"})]),l[3]||(l[3]=a("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-1"},"Latency",-1)),a("p",K,y("0"===we.value.ping?"...":`${we.value.ping} ms`),1)]),a("div",null,[a("div",Q,[d(i(j),{class:"w-6 h-6 text-green-600 dark:text-green-400"})]),l[4]||(l[4]=a("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-1"},"Download",-1)),a("p",W,y(we.value.download||"..."),1)]),a("div",null,[a("div",Z,[d(i(_),{class:"w-6 h-6 text-purple-600 dark:text-purple-400"})]),l[5]||(l[5]=a("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-1"},"Upload",-1)),a("p",$,y(we.value.upload||"..."),1)])])]),we.value.serverInfo.id?(t(),e("div",X,[a("h3",Y,[d(i(C),{class:"w-5 h-5 mr-3 text-purple-500"}),l[6]||(l[6]=g(" Test Server Information ",-1))]),a("div",ee,[a("div",null,[l[7]||(l[7]=a("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"ID",-1)),a("p",te,y(we.value.serverInfo.id),1)]),a("div",null,[l[8]||(l[8]=a("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Provider",-1)),a("p",ae,y(we.value.serverInfo.name),1)]),a("div",null,[l[9]||(l[9]=a("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Location",-1)),a("p",re,y(we.value.serverInfo.pos),1)])])])):m("",!0),we.value.result?(t(),e("div",le,[a("a",{href:we.value.result,target:"_blank",class:"inline-block group"},[a("img",{src:we.value.result+".png",alt:"Speedtest Result",class:"max-w-full h-auto rounded-xl shadow-lg group-hover:shadow-xl transition-all duration-300 group-hover:scale-105 border border-gray-200 dark:border-gray-700",style:{"max-width":"400px"}},null,8,oe),l[10]||(l[10]=a("p",{class:"text-sm text-gray-600 dark:text-gray-400 mt-3 group-hover:text-purple-500 transition-colors"},"Click to view full results",-1))],8,se)])):m("",!0)],512)):m("",!0)]),_:1})],512))}};export{ne as default};
